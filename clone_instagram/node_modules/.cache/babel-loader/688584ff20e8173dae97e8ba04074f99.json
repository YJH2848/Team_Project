{"ast":null,"code":"import _regeneratorRuntime from\"C:/instagram/clone_instagram/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/instagram/clone_instagram/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/instagram/clone_instagram/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState,useEffect,useContext}from'react';import AuthContext from\"../context/AuthProvider\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LOGIN_URL='http://127.0.0.1:8000/user/signin/';var Login=function Login(){var _useContext=useContext(AuthContext),setAuth=_useContext.setAuth;var userRef=useRef();var errRef=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPwd=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),errMsg=_useState6[0],setErrMsg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),success=_useState8[0],setSuccess=_useState8[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg('');},[email,password]);// const onImgInputBtnClick = (event: any) => {\n//     event.preventDefault();\n//     logoImgInput.current.click();\n// }\nvar handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _response$data,_response$data2,response,token,roles,_err$response,_err$response2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(LOGIN_URL,JSON.stringify({email:email,password:password}),{headers:{\"Content-Type\":'application/json'}});case 4:response=_context.sent;console.log(JSON.stringify(response===null||response===void 0?void 0:response.data));//console.log(JSON.stringify(response));\ntoken=response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.token;roles=response===null||response===void 0?void 0:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.roles;setAuth({email:email,password:password,roles:roles,token:token});setEmail('');setPwd('');setSuccess(true);_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](1);if(!(_context.t0!==null&&_context.t0!==void 0&&_context.t0.response)){setErrMsg('No Server Response');}else if(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===400){setErrMsg('Missing Username or Password');}else if(((_err$response2=_context.t0.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setErrMsg('Unauthorized');}else{setErrMsg('Login Failed');}errRef.current.focus();case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,14]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:success?/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"You are logged in!\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"Go to Home\"})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"login_container\",children:/*#__PURE__*/_jsxs(\"section\",{className:\"login_section\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"smart_img\",src:\"https://www.instagram.com/static/images/homepage/phones/home-phones.png/1dc085cdb87d.png\"}),/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?\"errmsg\":\"offscreen\",\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsxs(\"div\",{className:\"border\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"login_img\",width:\"185\",height:\"70\",src:\"./image/pngegg.png\"}),/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"email\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"useremail\"}),/*#__PURE__*/_jsx(\"input\",{className:\"login_input\",type:\"text\",id:\"useremail\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setEmail(e.target.value);},value:email,required:true,placeholder:\"\\uC0AC\\uC6A9\\uC790 \\uC774\\uB984 \\uB610\\uB294 \\uC774\\uBA54\\uC77C\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pwd\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\"}),/*#__PURE__*/_jsx(\"input\",{className:\"login_input\",type:\"password\",id:\"password\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setPwd(e.target.value);},value:password,required:true,placeholder:\"\\uBE44\\uBC00\\uBC88\\uD638\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"login_button\",children:\"\\uB85C\\uADF8\\uC778\"}),/*#__PURE__*/_jsx(\"div\",{className:\"line\",children:\"\\uB610\\uB294\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"noemail\",children:[\"\\uACC4\\uC815\\uC774 \\uC5C6\\uC73C\\uC2E0\\uAC00\\uC694?\\xA0\",/*#__PURE__*/_jsx(\"a\",{href:\"#\",className:\"join\",children:\"\\uAC00\\uC785\\uD558\\uAE30\"})]})]})})});};export default Login;","map":{"version":3,"names":["useRef","useState","useEffect","useContext","AuthContext","axios","LOGIN_URL","Login","setAuth","userRef","errRef","email","setEmail","password","setPwd","errMsg","setErrMsg","success","setSuccess","current","focus","handleSubmit","e","preventDefault","post","JSON","stringify","headers","response","console","log","data","token","roles","status","target","value"],"sources":["C:/instagram/clone_instagram/src/Login_components/Login.js"],"sourcesContent":["\nimport { useRef, useState, useEffect, useContext } from 'react';\nimport AuthContext from \"../context/AuthProvider\";\nimport axios from 'axios';\n\nconst LOGIN_URL = 'http://127.0.0.1:8000/user/signin/';\n\nconst Login = () => {\n    const { setAuth } = useContext(AuthContext);\n    const userRef = useRef();\n    const errRef = useRef();\n\n    const [email, setEmail] = useState('');\n    const [password, setPwd] = useState('');\n    const [errMsg, setErrMsg] = useState('');\n    const [success, setSuccess] = useState(false);\n\n    useEffect(() => {\n        userRef.current.focus();\n\n    }, [])\n    useEffect(() => {\n        setErrMsg('');\n    }, [email, password])\n\n    // const onImgInputBtnClick = (event: any) => {\n    //     event.preventDefault();\n    //     logoImgInput.current.click();\n    // }\n    const handleSubmit = async (e) => {\n        e.preventDefault(); {/*(e)코드를 작동하지 못하게 하는 메서드*/ }\n\n        try {\n            const response = await axios.post(LOGIN_URL,\n                JSON.stringify({ email, password }), {\n                headers: {\n                    \"Content-Type\": 'application/json',\n                },\n            });\n\n            console.log(JSON.stringify(response?.data));\n            //console.log(JSON.stringify(response));\n            const token = response?.data?.token;\n            const roles = response?.data?.roles;\n            setAuth({ email, password, roles, token });\n            setEmail('');\n            setPwd('');\n            setSuccess(true);\n        } catch (err) {\n            if (!err?.response) {\n                setErrMsg('No Server Response');\n            }\n            else if (err.response?.status === 400) {\n                setErrMsg('Missing Username or Password');\n            }\n            else if (err.response?.status === 401) {\n                setErrMsg('Unauthorized');\n            }\n            else {\n                setErrMsg('Login Failed');\n            }\n            errRef.current.focus();\n        }\n    }\n    return (\n        <>\n            {success ? (\n                <section>\n                    <h1>You are logged in!</h1>\n                    <br />\n                    <p>\n                        <a href=\"#\">Go to Home</a>\n                    </p>\n                </section>\n            ) : (\n                <div className=\"login_container\" >\n                    <section className='login_section'>\n                        <img className=\"smart_img\" src='https://www.instagram.com/static/images/homepage/phones/home-phones.png/1dc085cdb87d.png'></img>\n                        <p ref={errRef} className={errMsg ? \"errmsg\" :\n                            \"offscreen\"} aria-live=\"assertive\">{errMsg}</p>\n                        <div className='border'>\n                            <img className='login_img' width=\"185\" height=\"70\" src=\"./image/pngegg.png\"></img>\n                            <div className=\"login\">\n                                <form onSubmit={handleSubmit}> {/*form전송을 하기 전 입력된 데이터의 유효성 체크하는 것*/}\n                                    <div className=\"email\">\n                                        <label htmlFor=\"useremail\"></label>\n                                        <input\n                                            className='login_input'\n                                            type=\"text\"\n                                            id=\"useremail\"\n                                            ref={userRef}\n                                            autoComplete=\"off\"\n                                            onChange={(e) => setEmail(e.target.value)}\n                                            value={email}\n                                            required\n                                            placeholder=\"사용자 이름 또는 이메일\"\n                                        />\n                                    </div>\n                                    <div className=\"pwd\">\n                                        <label htmlFor=\"password\"></label>\n                                        <input\n                                            className='login_input'\n                                            type=\"password\"\n                                            id=\"password\"\n                                            ref={userRef}\n                                            autoComplete=\"off\"\n                                            onChange={(e) => setPwd(e.target.value)}\n                                            value={password}\n                                            required\n                                            placeholder=\"비밀번호\"\n                                        />\n                                    </div>\n\n                                    <button className='login_button'>로그인</button>\n                                    <div className='line'>\n                                        또는\n                                    </div>\n                                </form>\n\n                                {/* <div onSubmit={onImgInputBtnClick   }>\n                                        <input\n                                            ref={logoImgInput}\n                                            type='file'\n                                            className='imgInput'\n                                            id='logoImg'\n                                            accept='image/*'\n                                            name='file'\n                                            onChange={onImgChange} \n                                        />\n\n                                    </div> */}\n\n                            </div>\n                        </div>\n                        <div className='noemail'>\n                            계정이 없으신가요?&nbsp;<a href=\"#\" className='join'>가입하기</a>\n                        </div>\n                    </section>\n                </div>\n            )}\n        </>\n    )\n}\n\nexport default Login\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}